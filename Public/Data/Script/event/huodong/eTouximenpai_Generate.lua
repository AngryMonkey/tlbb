--太湖NPC
--造反恶贼
--普通

--脚本号
x808015_g_ScriptId	= 808015

--所拥有的事件ID列表
x808015_g_EventList	= { 808017 }
--接取任务的最低等级
x808015_g_minLevel			= 20
--活动每次tick时间
x808015_g_TimeTickIndex = 0

--后刷出的怪物的数量
x808015_g_RefreshMonsterNum = 5

--15分钟后刷出的怪物的位置
x808015_g_DLPosInfoList = {{
															sceneId=9,
															sceneName="少林",
															G1posList = {
																						{x=61, z=55, r=3},
																						{x=80, z=60, r=3},
																						{x=147, z=111, r=3},
																						{x=155, z=143, r=3},
																						{x=63, z=102, r=3},
																					},
															G2posList = {
																						{x=66, z=120, r=3},
																						{x=121, z=58, r=3},
																						{x=154, z=52, r=3},
																						{x=154, z=72, r=3},
																						{x=145, z=80, r=3},
																					},
														},
														{
															sceneId=10,
															sceneName="丐帮",
															G1posList = {
																						{x=50, z=150, r=3},
																						{x=60, z=150, r=3},
																						{x=54, z=136, r=3},
																						{x=57, z=110, r=3},
																						{x=70, z=102, r=3},
																					},
															G2posList = {
																						{x=114, z=93, r=3},
																						{x=133, z=83, r=3},
																						{x=154, z=63, r=3},
																						{x=155, z=46, r=3},
																						{x=111, z=36, r=3},
																					},
														},
														{
															sceneId=11,
															sceneName="明教",
															G1posList = {
																						{x=36, z=153, r=3},
																						{x=36, z=147, r=3},
																						{x=36, z=112, r=3},
																						{x=28, z=98, r=3},
																						{x=39, z=76, r=3},
																					},
															G2posList = {
																						{x=110, z=63, r=3},
																						{x=131, z=55, r=3},
																						{x=156, z=49, r=3},
																						{x=155, z=115, r=3},
																						{x=115, z=153, r=3},
																					},
														},
														{
															sceneId=12,
															sceneName="武当",
															G1posList = {
																						{x=43, z=95, r=3},
																						{x=40, z=55, r=3},
																						{x=68, z=182, r=3},
																						{x=55, z=179, r=3},
																						{x=43, z=168, r=3},
																					},
															G2posList = {
																						{x=45, z=146, r=3},
																						{x=95, z=126, r=3},
																						{x=108, z=128, r=3},
																						{x=93, z=112, r=3},
																						{x=86, z=84, r=3},
																					},
														},
														{
															sceneId=13,
															sceneName="天龙",
															G1posList = {
																						{x=65, z=150, r=3},
																						{x=64, z=152, r=3},
																						{x=42, z=136, r=3},
																						{x=37, z=131, r=3},
																						{x=23, z=126, r=3},
																					},
															G2posList = {
																						{x=40, z=100, r=3},
																						{x=50, z=100, r=3},
																						{x=64, z=91, r=3},
																						{x=65, z=73, r=3},
																						{x=50, z=75, r=3},
																					},
														},
														{
															sceneId=14,
															sceneName="逍遥",
															G1posList = {
																						{x=39, z=150, r=3},
																						{x=52, z=149, r=3},
																						{x=67, z=152, r=3},
																						{x=74, z=153, r=3},
																						{x=150, z=151, r=3},
																					},
															G2posList = {
																						{x=152, z=136, r=3},
																						{x=153, z=129, r=3},
																						{x=152, z=115, r=3},
																						{x=115, z=94, r=3},
																						{x=132, z=154, r=3},
																					},
														},
														{
															sceneId=15,
															sceneName="峨嵋",
															G1posList = {
																						{x=100, z=145, r=3},
																						{x=84, z=145, r=3},
																						{x=63, z=140, r=3},
																						{x=60, z=150, r=3},
																						{x=62, z=155, r=3},
																					},
															G2posList = {
																						{x=35, z=152, r=3},
																						{x=55, z=129, r=3},
																						{x=53, z=91, r=3},
																						{x=54, z=51, r=3},
																						{x=35, z=59, r=3},
																					},
														},
														{
															sceneId=16,
															sceneName="星宿",
															G1posList = {
																						{x=43, z=148, r=3},
																						{x=43, z=132, r=3},
																						{x=57, z=118, r=3},
																						{x=70, z=109, r=3},
																						{x=80, z=119, r=3},
																					},
															G2posList = {
																						{x=109, z=133, r=3},
																						{x=128, z=147, r=3},
																						{x=139, z=149, r=3},
																						{x=149, z=143, r=3},
																						{x=147, z=124, r=3},
																					},
														},
														{
															sceneId=17,
															sceneName="天山",
															G1posList = {
																						{x=43, z=146, r=3},
																						{x=50, z=140, r=3},
																						{x=47, z=132, r=3},
																						{x=60, z=126, r=3},
																						{x=42, z=124, r=3},
																					},
															G2posList = {
																						{x=34, z=110, r=3},
																						{x=33, z=100, r=3},
																						{x=67, z=82, r=3},
																						{x=126, z=44, r=3},
																						{x=131, z=52, r=3},
																					},
														},
													}
													

x808015_g_scenePosInfoList = {
	{sceneId=9, sceneLeader="玄慈", sceneName="少林", minL=30, maxL=45,  posList={
																						{x=42, z=48, r=3},{x=41, z=55, r=3},{x=42, z=65, r=3},{x=42, z=74, r=3},
																						{x=129, z=56, r=5},{x=42, z=100, r=5},{x=42, z=121, r=3},{x=48, z=139, r=3},
																						{x=54, z=146, r=3},{x=68, z=148, r=3},{x=42, z=130, r=3},{x=66, z=102, r=10},
																						{x=66, z=120, r=3},{x=55, z=98, r=3},{x=64, z=87, r=5},{x=70, z=90, r=5},
																						{x=79, z=96, r=5},{x=79, z=108, r=3},{x=85, z=105, r=3},{x=95, z=110, r=5},
																						{x=95, z=120, r=5},{x=95, z=129, r=3},{x=103, z=106, r=5},{x=113, z=106, r=3},
																						{x=117, z=116, r=3},{x=116, z=125, r=3},{x=125, z=102, r=8},{x=150, z=67, r=8},
																						{x=149, z=99, r=6},{x=153, z=144, r=6},
																					}
	},
	{sceneId=10, sceneLeader="宋慈", sceneName="丐帮", minL=46, maxL=60,  posList={
																						{x=46, z=36, r=5},{x=39, z=60, r=5},{x=45, z=76, r=3},{x=45, z=90, r=5},
																						{x=45, z=113, r=8},{x=49, z=198, r=8},{x=72, z=140, r=3},{x=83, z=141, r=4},
																						{x=101, z=141, r=4},{x=91, z=124, r=4},{x=72, z=115, r=6},{x=72, z=106, r=5},
																						{x=71, z=97, r=5},{x=97, z=106, r=3},{x=86, z=106, r=3},{x=79, z=60, r=5},
																						{x=104, z=61, r=5},{x=92, z=46, r=3},{x=54, z=55, r=3},{x=86, z=36, r=3},
																						{x=110, z=37, r=5},{x=125, z=63, r=5},{x=127, z=37, r=3},{x=154, z=50, r=4},
																						{x=154, z=62, r=4},{x=134, z=82, r=4},{x=149, z=113, r=4},{x=149, z=140, r=10},
																						{x=132, z=150, r=5},{x=112, z=110, r=5},
																					}
	},
	{sceneId=11, sceneLeader="林世长", sceneName="明教", minL=61, maxL=75,  posList={
																						{x=38, z=38, r=6},{x=35, z=53, r=6},{x=39, z=77, r=5},{x=36, z=87, r=4},
																						{x=35, z=97, r=5},{x=37, z=113, r=4},{x=38, z=140, r=5},{x=40, z=153, r=5},
																						{x=50, z=154, r=5},{x=60, z=154, r=5},{x=62, z=141, r=4},{x=81, z=153, r=5},
																						{x=81, z=139, r=5},{x=97, z=147, r=7},{x=97, z=110, r=5},{x=98, z=89, r=3},
																						{x=99, z=70, r=10},{x=84, z=71, r=5},{x=110, z=69, r=5},{x=114, z=136, r=5},
																						{x=114, z=152, r=5},{x=159, z=140, r=5},{x=140, z=117, r=5},{x=154, z=118, r=5},
																						{x=155, z=99, r=5},{x=143, z=78, r=5},{x=155, z=50, r=4},{x=155, z=36, r=4},
																						{x=115, z=39, r=5},{x=80, z=39, r=5},
																					}
	},
	{sceneId=12, sceneLeader="张玄素", sceneName="武当", minL=76, maxL=90,  posList={
																						{x=40, z=55, r=3},{x=54, z=57, r=4},{x=63, z=61, r=6},{x=45, z=70, r=3},
																						{x=45, z=78, r=3},{x=45, z=94, r=4},{x=63, z=99, r=5},{x=78, z=112, r=10},
																						{x=79, z=135, r=6},{x=94, z=137, r=3},{x=104, z=127, r=4},{x=90, z=179, r=5},
																						{x=60, z=180, r=8},{x=45, z=145, r=5},{x=45, z=164, r=5},{x=91, z=98, r=3},
																						{x=90, z=55, r=8},{x=74, z=58, r=4},{x=99, z=87, r=3},{x=78, z=92, r=5},
																						{x=95, z=111, r=4},{x=73, z=143, r=3},{x=58, z=68, r=3},{x=79, z=43, r=3},
																						{x=96, z=42, r=3},{x=98, z=66, r=4},{x=109, z=165, r=4},{x=80, z=50, r=3},
																						{x=70, z=83, r=3},{x=86, z=83, r=3},
																					}
	},
	{sceneId=13, sceneLeader="本因", sceneName="天龙", minL=91, maxL=100,posList={
																						{x=54, z=38, r=5},{x=41, z=46, r=5},{x=42, z=64, r=3},{x=40, z=76, r=7},
																						{x=55, z=74, r=5},{x=64, z=73, r=5},{x=42, z=104, r=4},{x=24, z=126, r=4},
																						{x=41, z=130, r=6},{x=95, z=38, r=5},{x=110, z=35, r=4},{x=153, z=35, r=4},
																						{x=146, z=56, r=5},{x=123, z=67, r=4},{x=95, z=71, r=5},{x=83, z=71, r=5},
																						{x=95, z=89, r=10},{x=65, z=96, r=5},{x=65, z=145, r=5},{x=65, z=123, r=5},
																						{x=95, z=128, r=5},{x=95, z=107, r=4},{x=117, z=114, r=5},{x=135, z=152, r=5},
																						{x=153, z=150, r=5},{x=155, z=126, r=5},{x=154, z=89, r=5},{x=128, z=94, r=5},
																						{x=139, z=35, r=3},{x=131, z=132, r=4},
																					}
	},
	{sceneId=14, sceneLeader="苏星河", sceneName="逍遥", minL=100, maxL=105, posList={
																						{x=48, z=55, r=5},{x=53, z=63, r=5},{x=46, z=72, r=4},{x=64, z=62, r=4},
																						{x=69, z=55, r=4},{x=118, z=90, r=10},{x=55, z=73, r=4},{x=49, z=127, r=3},
																						{x=65, z=135, r=5},{x=49, z=147, r=5},{x=70, z=150, r=5},{x=91, z=124, r=4},
																						{x=120, z=140, r=10},{x=119, z=154, r=5},{x=149, z=148, r=5},{x=150, z=129, r=6},
																						{x=149, z=119, r=5},{x=146, z=58, r=3},{x=157, z=58, r=3},{x=160, z=50, r=3},
																						{x=149, z=44, r=4},{x=139, z=43, r=4},{x=130, z=43, r=3},{x=130, z=136, r=5},
																						{x=41, z=152, r=3},{x=114, z=147, r=3},{x=41, z=150, r=3},{x=144, z=124, r=5},
																						{x=158, z=65, r=3},{x=121, z=42, r=3},
																					}
	},
	{sceneId=15, sceneLeader="孟青青", sceneName="峨嵋", minL=30, maxL=40,	posList={
																						{x=49, z=40, r=8},{x=39, z=46, r=5},{x=35, z=58, r=3},{x=56, z=54, r=4},
																						{x=54, z=93, r=3},{x=66, z=110, r=3},{x=39, z=108, r=5},{x=36, z=119, r=4},
																						{x=36, z=131, r=4},{x=39, z=149, r=8},{x=57, z=149, r=5},{x=56, z=138, r=4},
																						{x=56, z=130, r=4},{x=95, z=88, r=5},{x=95, z=69, r=5},{x=95, z=62, r=5},
																						{x=85, z=38, r=3},{x=106, z=48, r=4},{x=95, z=38, r=4},{x=85, z=38, r=3},
																						{x=105, z=38, r=3},{x=137, z=40, r=4},{x=149, z=40, r=5},{x=150, z=49, r=5},
																						{x=139, z=49, r=5},{x=140, z=74, r=5},{x=150, z=77, r=4},{x=139, z=106, r=8},
																						{x=152, z=108, r=5},{x=145, z=153, r=5},
																					}
	},
	{sceneId=16, sceneLeader="丁春秋", sceneName="星宿", minL=41, maxL=55,posList={
																						{x=46, z=53, r=3},{x=40, z=84, r=5},{x=50, z=83, r=5},{x=43, z=93, r=4},
																						{x=45, z=130, r=5},{x=43, z=148, r=4},{x=55, z=140, r=5},{x=70, z=140, r=10},
																						{x=90, z=140, r=9},{x=99, z=130, r=8},{x=95, z=110, r=5},{x=84, z=114, r=5},
																						{x=70, z=108, r=5},{x=60, z=118, r=5},{x=110, z=113, r=5},{x=110, z=125, r=5},
																						{x=109, z=146, r=3},{x=125, z=147, r=5},{x=137, z=149, r=3},{x=144, z=140, r=5},
																						{x=147, z=126, r=5},{x=126, z=100, r=6},{x=143, z=93, r=5},{x=147, z=55, r=3},
																						{x=123, z=73, r=3},{x=96, z=91, r=5},{x=95, z=53, r=5},{x=115, z=54, r=4},
																						{x=68, z=63, r=5},{x=62, z=96, r=5},
																					}
	},
	{sceneId=17, sceneLeader="梅剑", sceneName="天山", minL=56, maxL=70,posList={
																						{x=40, z=47, r=8},{x=41, z=67, r=5},{x=36, z=76, r=5},{x=33, z=88, r=5},
																						{x=33, z=100, r=4},{x=35, z=110, r=5},{x=49, z=126, r=7},{x=39, z=146, r=6},
																						{x=50, z=140, r=5},{x=62, z=126, r=4},{x=49, z=110, r=5},{x=49, z=77, r=5},
																						{x=66, z=87, r=5},{x=70, z=99, r=8},{x=85, z=100, r=5},{x=100, z=100, r=5},
																						{x=95, z=79, r=5},{x=85, z=72, r=5},{x=90, z=50, r=8},{x=109, z=49, r=7},
																						{x=125, z=50, r=5},{x=153, z=61, r=5},{x=152, z=82, r=5},{x=126, z=80, r=8},
																						{x=122, z=96, r=5},{x=135, z=124, r=5},{x=153, z=143, r=5},{x=82, z=119, r=5},
																						{x=107, z=120, r=4},{x=61, z=41, r=4},
																					}
	},
}

--**********************************
--事件交互入口 19-145-40 18-149-48
--**********************************
function x808015_OnDefaultEvent( sceneId, actId, param1, param2, param3, param4, param5 )
			for i, v in x808015_g_scenePosInfoList do
				if v.sceneId == sceneId then
						StartOneActivity( sceneId, actId, floor(900000))
						SetActivityParam(sceneId, actId, x808015_g_TimeTickIndex, 0)
				    local j=1
						while j<=30 do
							
							local index = j							
							--local strText = format( "当前sceneid: %d, %d-%d,%d", sceneId, v.sceneId, v.posList[index].x, v.posList[index].z)
							--PrintStr(strText)
							MonsterId = LuaFnCreateMonster( sceneId, 486, v.posList[index].x, v.posList[index].z, 3, -1, 808017 )
							SetCharacterDieTime(sceneId, MonsterId, 1000*60*60)									
							j = j+1									
						end
						local NotifyMsg = "@*;SrvMsg;SCA:#P"..v.sceneLeader.."#P: 我#Y"..v.sceneName.."#P突遭一批#G江湖宵小#P偷袭，请各位门下弟子速回门派肃清来敌。"
						AddGlobalCountNews( sceneId, NotifyMsg )
						return
				end				
		end
end


--**********************************
--心跳函数
--**********************************
function x808015_OnTimer( sceneId, actId, uTime )

		local TickTime = GetActivityParam(sceneId, actId, x808015_g_TimeTickIndex)
		TickTime = TickTime+1
		SetActivityParam(sceneId, actId, x808015_g_TimeTickIndex, TickTime)
		
		if TickTime == 1 then
		
			for i, v in x808015_g_DLPosInfoList do
				if v.sceneId == sceneId then
					local j = 1
					while j<=x808015_g_RefreshMonsterNum do
						local MonsterId = LuaFnCreateMonster( sceneId, 486, v.G1posList[j].x, v.G1posList[j].z, 3, -1, 808017 )
						j = j+1
					end
					--return
				end
			end
			
			-- 增加5个怪，位置在30个中随机
			for i, v in x808015_g_scenePosInfoList do
				if v.sceneId == sceneId then
					local j = 1
					while j<=x808015_g_RefreshMonsterNum do
						k = (j-1)*6 + random(5)
						local MonsterId = LuaFnCreateMonster( sceneId, 486, v.posList[k].x, v.posList[k].z, 3, -1, 808017 )
						
						--PrintNum(MonsterId)
						j = j+1
					end
					return
				end
			end
		
		end
		
		
		if TickTime == 2 then
		
			for i, v in x808015_g_DLPosInfoList do
				if v.sceneId == sceneId then
					local j = 1
					while j<=x808015_g_RefreshMonsterNum do
						local MonsterId = LuaFnCreateMonster( sceneId, 486, v.G2posList[j].x, v.G2posList[j].z, 3, -1, 808017 )
						j = j+1
					end
					return
				end
			end
		
		end

		
end
